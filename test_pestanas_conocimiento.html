<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª Test - Sistema de PestaÃ±as</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { border-color: #4CAF50; background: #f8fff8; }
        .error { border-color: #f44336; background: #fff8f8; }
        .warning { border-color: #ff9800; background: #fffdf8; }
        .info { border-color: #2196F3; background: #f8f9ff; }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #005a8a; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .highlight { background: yellow; }
        
        /* Estilos para las pestaÃ±as de prueba */
        .tab-button {
            padding: 8px 16px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-right: 10px;
        }
        .tab-button.active {
            border-bottom-color: #14b8a6;
            color: #14b8a6;
            background: #f0fdfa;
        }
        .tab-content {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 10px;
        }
        .hidden { display: none; }
        #log-container {
            max-height: 400px;
            overflow-y: auto;
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª Test - Sistema de PestaÃ±as del Panel de Conocimiento</h1>
        <p><strong>Objetivo:</strong> Diagnosticar y probar el sistema de pestaÃ±as</p>
        
        <div class="test-section info">
            <h3>ğŸ“‹ Instrucciones:</h3>
            <ol>
                <li>Este test simula las pestaÃ±as del panel de conocimiento</li>
                <li>Usa los botones de abajo para probar la funcionalidad</li>
                <li>Revisa la consola para diagnÃ³sticos detallados</li>
                <li>Los logs aparecerÃ¡n en el Ã¡rea de abajo</li>
            </ol>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ¯ PestaÃ±as de Prueba</h2>
        
        <!-- SimulaciÃ³n de pestaÃ±as -->
        <div class="mb-6">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8">
                    <button class="tab-button active" data-tab="ver-conocimiento">
                        ğŸ‘ï¸ Ver Conocimiento
                    </button>
                    <button class="tab-button" data-tab="agregar-conocimiento">
                        â• Agregar Nuevo
                    </button>
                    <button class="tab-button" data-tab="gestionar-etiquetas">
                        ğŸ·ï¸ Gestionar Etiquetas
                    </button>
                </nav>
            </div>
        </div>

        <!-- Contenidos de pestaÃ±as -->
        <div id="tab-ver-conocimiento" class="tab-content">
            <h3>ğŸ‘ï¸ Ver Conocimiento</h3>
            <p>Esta es la pestaÃ±a de visualizaciÃ³n del conocimiento.</p>
            <p>AquÃ­ se mostrarÃ­an todos los bloques de conocimiento existentes.</p>
        </div>

        <div id="tab-agregar-conocimiento" class="tab-content hidden">
            <h3>â• Agregar Nuevo</h3>
            <p>Esta es la pestaÃ±a para agregar nuevo conocimiento.</p>
            <p>AquÃ­ estarÃ­a el formulario para crear nuevos bloques.</p>
            <form>
                <textarea placeholder="Contenido del conocimiento..." rows="3" style="width:100%; margin:10px 0;"></textarea>
                <input type="text" placeholder="Etiquetas separadas por comas" style="width:100%; margin:10px 0;">
                <button type="button">Agregar Conocimiento</button>
            </form>
        </div>

        <div id="tab-gestionar-etiquetas" class="tab-content hidden">
            <h3>ğŸ·ï¸ Gestionar Etiquetas</h3>
            <p>Esta es la pestaÃ±a para gestionar etiquetas.</p>
            <p>AquÃ­ se mostrarÃ­an estadÃ­sticas y gestiÃ³n de etiquetas.</p>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ”§ Controles de Prueba</h2>
        <button onclick="ejecutarDiagnostico()">ğŸ” Ejecutar DiagnÃ³stico</button>
        <button onclick="probarPestaÃ±a('ver-conocimiento')">ğŸ‘ï¸ Probar Ver</button>
        <button onclick="probarPestaÃ±a('agregar-conocimiento')">â• Probar Agregar</button>
        <button onclick="probarPestaÃ±a('gestionar-etiquetas')">ğŸ·ï¸ Probar Gestionar</button>
        <button onclick="reinicializarPestaÃ±as()">ğŸ”„ Reinicializar</button>
        <button onclick="limpiarLog()">ğŸ§¹ Limpiar Log</button>
    </div>

    <div class="container">
        <h2>ğŸ“Š Log en Tiempo Real</h2>
        <div id="log-container"></div>
    </div>

    <div class="container">
        <h2>ğŸ“ CÃ³digo para Consola del Panel Real</h2>
        <p>Copia este cÃ³digo en la consola del panel de entrenamiento:</p>
        <pre id="codigo-panel"></pre>
        <button onclick="copiarCodigo()">ğŸ“‹ Copiar CÃ³digo</button>
    </div>

    <!-- Cargar los scripts necesarios -->
    <script>
        // CÃ³digo de diagnÃ³stico integrado
        let logContainer;
        
        function log(mensaje) {
            if (!logContainer) {
                logContainer = document.getElementById('log-container');
            }
            const timestamp = new Date().toLocaleTimeString();
            logContainer.innerHTML += `[${timestamp}] ${mensaje}\n`;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(mensaje);
        }
        
        function limpiarLog() {
            if (logContainer) {
                logContainer.innerHTML = '';
            }
        }

        // Estado global simplificado
        window.PANEL_STATE = {
            currentTab: 'ver-conocimiento',
            initialized: false
        };

        // FunciÃ³n switchTab simplificada
        function switchTab(targetTab, tabButtons, tabContents) {
            log(`ğŸ¯ Cambiando a pestaÃ±a: ${targetTab}`);
            
            if (!tabButtons) tabButtons = document.querySelectorAll('.tab-button');
            if (!tabContents) tabContents = document.querySelectorAll('.tab-content');
            
            // Desactivar todos los botones
            tabButtons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Activar botÃ³n objetivo
            const activeButton = document.querySelector(`[data-tab="${targetTab}"]`);
            if (activeButton) {
                activeButton.classList.add('active');
                log(`âœ… BotÃ³n activado: ${targetTab}`);
            } else {
                log(`âŒ BotÃ³n no encontrado: ${targetTab}`);
            }

            // Ocultar todos los contenidos
            tabContents.forEach(content => {
                content.classList.add('hidden');
            });
            
            // Mostrar contenido objetivo
            const targetContent = document.getElementById('tab-' + targetTab);
            if (targetContent) {
                targetContent.classList.remove('hidden');
                log(`âœ… Contenido mostrado: tab-${targetTab}`);
            } else {
                log(`âŒ Contenido no encontrado: tab-${targetTab}`);
            }
            
            window.PANEL_STATE.currentTab = targetTab;
            return true;
        }

        // FunciÃ³n initializeTabs
        function initializeTabs() {
            log('ğŸ”„ Inicializando sistema de pestaÃ±as...');
            
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            log(`   - Botones encontrados: ${tabButtons.length}`);
            log(`   - Contenidos encontrados: ${tabContents.length}`);

            tabButtons.forEach((button, index) => {
                const targetTab = button.getAttribute('data-tab');
                log(`   - Configurando botÃ³n ${index + 1}: ${targetTab}`);
                
                // Remover eventos anteriores
                button.onclick = null;
                
                // Agregar nuevo evento
                button.addEventListener('click', () => {
                    log(`ğŸ–±ï¸ Clic en pestaÃ±a: ${targetTab}`);
                    switchTab(targetTab, tabButtons, tabContents);
                });
            });
            
            window.PANEL_STATE.initialized = true;
            log('âœ… Sistema de pestaÃ±as inicializado');
        }

        // Funciones de prueba
        function ejecutarDiagnostico() {
            log('ğŸ§ª INICIANDO DIAGNÃ“STICO COMPLETO...');
            log('============================================');

            // Verificar elementos
            const elementos = {
                'botones pestaÃ±as': document.querySelectorAll('.tab-button'),
                'contenidos': document.querySelectorAll('.tab-content'),
                'ver-conocimiento botÃ³n': document.querySelector('[data-tab="ver-conocimiento"]'),
                'agregar-conocimiento botÃ³n': document.querySelector('[data-tab="agregar-conocimiento"]'),
                'gestionar-etiquetas botÃ³n': document.querySelector('[data-tab="gestionar-etiquetas"]'),
                'tab-ver-conocimiento': document.getElementById('tab-ver-conocimiento'),
                'tab-agregar-conocimiento': document.getElementById('tab-agregar-conocimiento'),
                'tab-gestionar-etiquetas': document.getElementById('tab-gestionar-etiquetas')
            };

            Object.entries(elementos).forEach(([nombre, elemento]) => {
                if (elemento && elemento.length !== undefined) {
                    log(`   âœ… ${nombre}: ${elemento.length} elementos`);
                } else {
                    const existe = elemento !== null;
                    log(`   ${existe ? 'âœ…' : 'âŒ'} ${nombre}: ${existe ? 'Encontrado' : 'NO ENCONTRADO'}`);
                }
            });

            log('============================================');
        }

        function probarPestaÃ±a(nombrePestaÃ±a) {
            log(`\nğŸ§ª PROBANDO PESTAÃ‘A: ${nombrePestaÃ±a}`);
            const resultado = switchTab(nombrePestaÃ±a);
            if (resultado) {
                log(`âœ… PestaÃ±a ${nombrePestaÃ±a} cambiada exitosamente`);
            } else {
                log(`âŒ Error cambiando a pestaÃ±a ${nombrePestaÃ±a}`);
            }
        }

        function reinicializarPestaÃ±as() {
            log('\nğŸ”„ REINICIALIZANDO...');
            initializeTabs();
        }

        // CÃ³digo para el panel real
        const codigoPanelReal = `
// ğŸ§ª DIAGNÃ“STICO PESTAÃ‘AS PANEL REAL
console.log('ğŸ§ª INICIANDO DIAGNÃ“STICO EN PANEL REAL...');

// Verificar elementos del DOM
const botonesPestaÃ±as = document.querySelectorAll('.tab-button');
const contenidosPestaÃ±as = document.querySelectorAll('.tab-content');

console.log('Botones encontrados:', botonesPestaÃ±as.length);
console.log('Contenidos encontrados:', contenidosPestaÃ±as.length);

// Verificar funciones
console.log('switchTab disponible:', typeof window.switchTab);
console.log('initializeTabs disponible:', typeof window.initializeTabs);

// Reinicializar sistema
if (typeof window.initializeTabs === 'function') {
    window.initializeTabs();
    console.log('âœ… Sistema reinicializado');
} else {
    console.log('âŒ initializeTabs no disponible');
}

// Probar cambio a "Agregar Nuevo"
setTimeout(() => {
    if (typeof window.switchTab === 'function') {
        window.switchTab('agregar-conocimiento', botonesPestaÃ±as, contenidosPestaÃ±as);
        console.log('âœ… Intentando cambiar a agregar-conocimiento');
    } else {
        console.log('âŒ switchTab no disponible');
    }
}, 1000);

// Funciones de prueba
window.probarAgregar = () => {
    const botones = document.querySelectorAll('.tab-button');
    const contenidos = document.querySelectorAll('.tab-content');
    window.switchTab('agregar-conocimiento', botones, contenidos);
};

console.log('ğŸ’¡ Ejecuta: probarAgregar()');
        `;

        document.getElementById('codigo-panel').textContent = codigoPanelReal.trim();

        function copiarCodigo() {
            navigator.clipboard.writeText(document.getElementById('codigo-panel').textContent).then(() => {
                log('ğŸ“‹ CÃ³digo copiado al portapapeles');
            });
        }

        // Exportar funciones globalmente
        window.switchTab = switchTab;
        window.initializeTabs = initializeTabs;
        window.probarPestaÃ±a = probarPestaÃ±a;
        window.reinicializarPestaÃ±as = reinicializarPestaÃ±as;
        window.ejecutarDiagnostico = ejecutarDiagnostico;

        // Auto-inicializaciÃ³n
        document.addEventListener('DOMContentLoaded', () => {
            log('ğŸ“š PÃ¡gina cargada, inicializando...');
            initializeTabs();
            
            // Auto-diagnÃ³stico despuÃ©s de un momento
            setTimeout(ejecutarDiagnostico, 500);
        });
    </script>
</body>
</html>
