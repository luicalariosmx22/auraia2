<!-- âœ… Archivo: clientes/aura/templates/panel_cliente_google_ads/index.html -->
<!-- ðŸ‘‰ Vista principal del mÃ³dulo Google Ads con branding tipo tarjetas -->

{% extends "base_cliente.html" %}
{% block contenido %}

<h1 class="text-3xl font-bold text-nora-primary text-center mb-10">Â¿QuÃ© quieres hacer con Google Ads?</h1>

<!-- Selector de Empresa -->
<div class="max-w-4xl mx-auto mb-8">
  <div class="bg-white rounded-lg shadow p-6 border-l-4 border-purple-500">
    <h2 class="text-xl font-bold text-purple-600 mb-4">Selecciona la Empresa</h2>
    <form id="empresaForm" class="space-y-4">
      <div class="flex items-center space-x-4">
        <select id="empresa_id" name="empresa_id" class="flex-1 form-select rounded-md border-gray-300 shadow-sm">
          <option value="">Selecciona una empresa...</option>
          {% for empresa in empresas %}
          <option value="{{ empresa.id }}" {% if empresa_id == empresa.id %}selected{% endif %}>
            {{ empresa.nombre }}
          </option>
          {% endfor %}
        </select>
        <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">
          Guardar SelecciÃ³n
        </button>
      </div>
    </form>
  </div>
</div>

<div class="grid grid-cols-1 sm:grid-cols-2 gap-6 max-w-4xl mx-auto">
  
  <!-- CampaÃ±as -->
  <div class="bg-white rounded-lg shadow p-6 border-t-4 border-blue-500">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-blue-600">CampaÃ±as</h2>
      <span>ðŸ“£</span>
    </div>
    <p class="text-gray-600 mb-4">
      Crea, administra y consulta campaÃ±as activas en Google Ads.
    </p>
    <a href="#" class="inline-block bg-blue-600 text-white text-sm px-4 py-2 rounded hover:bg-blue-700">
      Ir a CampaÃ±as
    </a>
  </div>

  <!-- Reportes -->
  <div class="bg-white rounded-lg shadow p-6 border-t-4 border-green-500">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-green-600">Reportes</h2>
      <span>ðŸ“„</span>
    </div>
    <p class="text-gray-600 mb-4">
      Consulta el histÃ³rico de reportes automÃ¡ticos y resultados de tus campaÃ±as.
    </p>
    <a href="{{ url_for('panel_cliente_google_ads.reporte_google_ads', nombre_nora=nombre_nora) }}" class="inline-block bg-green-600 text-white text-sm px-4 py-2 rounded hover:bg-green-700">
      Ir a Reportes
    </a>
  </div>

  <!-- Google Ads Lab -->
  <div class="bg-white rounded-lg shadow p-6 border-t-4 border-yellow-400">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-yellow-600">Google Ads Lab</h2>
      <span>ðŸ§ª</span>
    </div>
    <p class="text-gray-600 mb-4">
      Explora y prueba endpoints de la API de Google Ads en modo laboratorio.
    </p>
    <a href="#" class="inline-block bg-yellow-500 text-white text-sm px-4 py-2 rounded hover:bg-yellow-600">
      Ir al Ads Lab
    </a>
  </div>

  <!-- Cuentas Publicitarias -->
  <div class="bg-white rounded-lg shadow p-6 border-t-4 border-indigo-500">
    <div class="flex items-center justify-between mb-4">
      <h2 class="text-xl font-bold text-indigo-600">Cuentas Publicitarias</h2>
      <span>ðŸ§¾</span>
    </div>
    <p class="text-gray-600 mb-4">
      Consulta y administra todas tus cuentas de Google Ads activas.
    </p>
    <a href="{{ url_for('panel_cliente_google_ads.ver_cuentas_google_ads', nombre_nora=nombre_nora) }}" class="inline-block bg-indigo-600 text-white text-sm px-4 py-2 rounded hover:bg-indigo-700">
      Ver cuentas
    </a>
  </div>

</div>

{% endblock %}

{% block extra_js %}
<script>
document.getElementById('empresaForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const empresa_id = document.getElementById('empresa_id').value;
    if (!empresa_id) {
        alert('Por favor selecciona una empresa');
        return;
    }
    
    try {
        const response = await fetch("{{ url_for('panel_cliente_google_ads.actualizar_empresa', nombre_nora=nombre_nora) }}", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ empresa_id })
        });
        
        if (!response.ok) {
            throw new Error('Error al actualizar empresa');
        }
        
        // Recargar la pÃ¡gina para reflejar la nueva selecciÃ³n
        window.location.reload();
    } catch (error) {
        console.error('Error:', error);
        alert('Error al actualizar empresa: ' + error.message);
    }
});
</script>
{% endblock %}
