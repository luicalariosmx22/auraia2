{% extends "base_cliente.html" %}

{% block contenido %}
<div class="container mx-auto max-w-6xl px-4 py-6">
  <h2 class="text-2xl font-bold text-gray-800 mb-6">🏢 Empresas registradas</h2>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <ul class="mb-4 space-y-1">
        {% for category, message in messages %}
          <li class="text-sm px-4 py-2 rounded bg-green-100 text-green-800">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

  {% if empresas %}
    {% for empresa in empresas %}
      <div class="bg-white shadow-sm border border-gray-200 rounded-lg p-4 mb-4 grid sm:grid-cols-4 gap-4 items-start">
        <!-- Info -->
        <div class="col-span-2">
          <h3 class="text-lg font-semibold text-gray-900 mb-1">{{ empresa.nombre_empresa }}</h3>
          {% if empresa.giro %}<p class="text-sm text-gray-600 mb-1">🧭 Giro: {{ empresa.giro }}</p>{% endif %}
          {% if empresa.email_empresa %}<p class="text-sm text-gray-600 mb-1">✉️ {{ empresa.email_empresa }}</p>{% endif %}
          {% if empresa.telefono_empresa %}<p class="text-sm text-gray-600">📞 {{ empresa.telefono_empresa }}</p>{% endif %}
        </div>

        <!-- Cliente asociado -->
        <div class="col-span-1">
          {% if empresa.cliente %}
            <p class="text-sm text-gray-700">👤 <span class="font-semibold">{{ empresa.cliente.nombre_cliente }}</span></p>
          {% else %}
            <p class="text-sm text-orange-600 flex items-center">
              ⚠️ <span class="ml-1">Sin cliente vinculado</span>
            </p>
          {% endif %}
        </div>

        <!-- Acciones -->
        <div class="col-span-1 flex flex-col gap-2 items-start">
          <a href="{{ empresa.url_editar }}" class="text-sm text-blue-600 hover:underline">✏️ Editar</a>
          <a href="{{ empresa.url_ligar }}" class="text-sm text-blue-600 hover:underline">➕ Ligar cliente</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-gray-600 text-sm">No hay empresas registradas aún.</p>
  {% endif %}
</div>
{% endblock %}
