<!-- üëâ Modal reutilizable para crear o editar un bloque de conocimiento -->

<div id="modal-bloque" class="modal hidden">
  <div class="modal-content bg-white rounded shadow p-6 max-w-xl mx-auto">
    <h2 class="text-xl font-semibold mb-4">
      {% if bloque %}‚úèÔ∏è Editar bloque{% else %}‚ûï Nuevo bloque de conocimiento{% endif %}
    </h2>

    <!-- üìÑ Formulario -->
    <form method="POST" action="{% if bloque %}/editar/{{ bloque.id }}{% else %}/crear{% endif %}">
      <!-- ‚úçÔ∏è Contenido -->
      <label class="block mb-2 font-medium">Contenido (m√°x. 500 caracteres):</label>
      <textarea name="contenido" maxlength="500" rows="4" required
        class="form-textarea w-full mb-4">{{ bloque.contenido if bloque else '' }}</textarea>

      <!-- üè∑Ô∏è Etiquetas -->
      <label class="block mb-2 font-medium">Etiquetas:</label>
      <select name="etiquetas" multiple class="form-multiselect w-full mb-4">
        {% for etiqueta in etiquetas_disponibles %}
        <option value="{{ etiqueta }}" {% if bloque and etiqueta in bloque.etiquetas %}selected{% endif %}>{{ etiqueta }}</option>
        {% endfor %}
      </select>

      <!-- ‚≠ê Prioridad -->
      <div class="mb-4">
        <label class="inline-flex items-center">
          <input type="checkbox" name="prioridad" class="form-checkbox"
            {% if bloque and bloque.prioridad %}checked{% endif %}>
          <span class="ml-2">‚≠ê Marcar como prioritario</span>
        </label>
      </div>

      <!-- üß† Origen (solo edici√≥n)  a-->
      {% if bloque %}
      <div class="mb-2 text-sm text-gray-600">
        Origen: 
        {% if bloque.origen == 'manual' %}üß† Manual
        {% elif bloque.origen == 'pdf' %}üìÑ PDF
        {% elif bloque.origen == 'ia' %}ü§ñ IA
        {% endif %}
      </div>
      {% endif %}

      <!-- üîò Activo toggle (solo edici√≥n) -->
      {% if bloque %}
      <div class="mb-4">
        <label class="inline-flex items-center">
          <input type="checkbox" name="activo" class="form-checkbox"
            {% if bloque.activo %}checked{% endif %}>
          <span class="ml-2">Bloque activo</span>
        </label>
      </div>
      {% endif %}

      <!-- üß≠ Botones -->
      <div class="flex justify-end gap-4 mt-6">
        <button type="button" class="btn btn-outline" onclick="cerrarModal()">Cancelar</button>
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </form>
  </div>
</div>
