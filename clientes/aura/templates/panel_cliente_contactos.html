<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Contactos - Nora AI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
</head>
<body>
    <header>
        <div class="logo">üìá Contactos - Nora AI</div>
        <div class="logout"><a href="/logout">Cerrar sesi√≥n</a></div>
    </header>

    <main>
        <h2>Contactos registrados</h2>

        {% with mensajes = get_flashed_messages() %}
            {% if mensajes %}
                <div class="flash">{{ mensajes[0] }}</div>
            {% endif %}
        {% endwith %}

        <table class="noras-table">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Tel√©fono</th>
                    <th>Etiquetas</th>
                    {% if ia_permitida %}
                        <th>IA</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for c in contactos %}
                <tr>
                    <td>{{ c.nombre }}</td>
                    <td>{{ c.numero }}</td>
                    <td>
                        {% for et in c.etiquetas %}
                            <span class="badge">{{ et }}</span>
                        {% endfor %}
                    </td>
                    {% if ia_permitida %}
                    <td>
                        <form method="POST" action="/panel_cliente/contactos/{{ nombre_nora }}/toggle_ia">
                            <input type="hidden" name="numero" value="{{ c.numero }}">
                            {% if c.ia %}
                                <button type="submit" class="btn-desactivar">Desactivar IA</button>
                            {% else %}
                                <button type="submit" class="btn-activar">Activar IA</button>
                            {% endif %}
                        </form>
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <h3>‚ûï Agregar nuevo contacto</h3>
        <form method="POST" class="form-contacto">
            <input type="text" name="nombre" placeholder="Nombre completo" required>
            <input type="text" name="telefono" placeholder="N√∫mero WhatsApp" required>
            <input type="text" name="etiquetas" placeholder="Ej: cliente, vip, interesado">
            <button type="submit">üíæ Guardar</button>
        </form>

        <p><a href="{{ url_for('panel_cliente.panel_cliente', nombre_nora=nombre_nora) }}">‚Üê Volver al panel</a></p>
    </main>
</body>
</html>
