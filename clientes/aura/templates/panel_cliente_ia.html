<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Control IA - Nora {{ nombre_nora | default("Desconocida") }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
</head>
<body>
    <header>
        <div class="logo">âš™ï¸ Control de IA - Nora: {{ nombre_nora | default("Desconocida") }}</div>
        <div class="logout"><a href="/logout">Cerrar sesiÃ³n</a></div>
    </header>

    <main>
        <h2>Estado actual de la Inteligencia Artificial</h2>

        {% if ia_activada %}
            <p>ğŸ¤– <strong>La IA estÃ¡ ACTIVADA.</strong> Nora responderÃ¡ automÃ¡ticamente.</p>
        {% else %}
            <p>ğŸ›‘ <strong>La IA estÃ¡ DESACTIVADA.</strong> El cliente tomarÃ¡ control manual del chat.</p>
        {% endif %}

        <form method="POST">
            <input type="hidden" name="ia_activada" value="{{ not ia_activada }}">
            <button type="submit">
                {% if ia_activada %}
                    ğŸ”Œ Desactivar IA
                {% else %}
                    âš¡ Activar IA
                {% endif %}
            </button>
        </form>

        <h3>âœ‰ï¸ Mensaje de bienvenida</h3>
        <p>Este mensaje se enviarÃ¡ automÃ¡ticamente cuando el usuario escriba por primera vez.</p>
        <form method="POST">
            <textarea name="mensaje_bienvenida" rows="6" style="width: 100%;">{{ mensaje_bienvenida }}</textarea>
            <input type="hidden" name="ia_activada" value="{{ ia_activada }}">
            <button type="submit">ğŸ’¾ Guardar cambios</button>
        </form>

        <hr>
        <h3>ğŸ“š Conocimiento cargado en Nora</h3>
        <p>Estos bloques son interpretados por la IA para responder mejor. Puedes editarlos o eliminarlos.</p>

        {% for bloque in conocimientos %}
            <form method="POST" action="/panel_cliente/ia/{{ nombre_nora }}/editar_conocimiento/{{ bloque.id }}" style="margin-bottom: 20px;">
                <label><strong>TÃ­tulo:</strong></label><br>
                <input type="text" name="titulo" value="{{ bloque.titulo }}" style="width: 100%;"><br><br>

                <label><strong>Contenido:</strong></label><br>
                <textarea name="contenido" rows="4" style="width: 100%;">{{ bloque.contenido }}</textarea><br>

                <button type="submit">ğŸ’¾ Guardar</button>
                <a href="/panel_cliente/ia/{{ nombre_nora }}/borrar_conocimiento/{{ bloque.id }}" style="color: red; margin-left: 10px;">ğŸ—‘ Eliminar</a>
            </form>
        {% else %}
            <p>âŒ No hay contenido registrado aÃºn.</p>
        {% endfor %}

        <br><br>
        <a href="{{ url_for('panel_cliente.panel_cliente', nombre_nora=nombre_nora) }}" class="boton">â† Volver al panel del cliente</a>
    </main>
</body>
</html>
